var googletag=googletag||{};googletag.cmd=googletag.cmd||[];window.IOLMetrics=window.IOLMetrics||[];window.IOLMetricsTrack=window.IOLMetricsTrack||function(e,n,i,t,o,a){try{if(typeof n=="undefined")n=false;if(n===false)n=Date.now();window.IOLMetrics.push([e,n,i,t,o,a])}catch(e){}};var advSlots=new Array;function trackADVPerformance(){googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(e){try{var n=e.slot.getSlotElementId();var i={};i.id=n;i.size=e.size!=null?e.size[0]+"x"+e.size[1]:"empty";advSlots.push(i);var t=n=="admputop"?n+"_renderended":""}catch(e){console.log("error tracking performance in slotRenderEnded"+e)}scriptsToBeDelayed()});googletag.pubads().addEventListener("impressionViewable",function(e){try{var n=e.slot.getSlotElementId();function i(e){return e.id===n}var t=advSlots.find(i);var o=n=="admputop"?n+"_viewable":""}catch(e){console.log("error tracking performance in impressionViewable"+e)}});googletag.pubads().addEventListener("slotOnload",function(e){try{var n=e.slot.getSlotElementId();function i(e){return e.id===n}var t=advSlots.find(i);var o=n=="admputop"?n+"_load":""}catch(e){console.log("error tracking performance in slotOnload"+e)}})})}(function(e){if(typeof e.IOL==="undefined")e.IOL={};if(typeof IOL.cmp==="undefined"){IOL.cmp={};IOL.cmp.iubenda=null;IOL.cmp.tcf=null;IOL.cmp.both=null;if(typeof IOL.cmp.callbacks==="undefined")IOL.cmp.callbacks=[];var n=function(){if(IOL.cmp.iubenda===null||IOL.cmp.tcf===null)return;IOL.cmp.both=IOL.cmp.iubenda&&IOL.cmp.tcf;console.log("*** CMP CALLBACK",IOL.cmp.iubenda,IOL.cmp.tcf,IOL.cmp.callbacks.length);for(var e=0;e<IOL.cmp.callbacks.length;e++)IOL.cmp.callbacks[e](IOL.cmp.both,IOL.cmp.iubenda,IOL.cmp.tcf);IOL.cmp.callbacks.push=function(e){e(IOL.cmp.both,IOL.cmp.iubenda,IOL.cmp.tcf)}};var i=function(){if(IOL.cmp.iubenda!==null)return;var e=true;if(typeof _iolconsent.data!=="undefined"&&typeof _iolconsent.data.purposes!=="undefined"){for(var i=1;i<=5;i++){if(i!==2){var t=false;if(typeof _iolconsent.data.purposes[i]!=="undefined")t=_iolconsent.data.purposes[i];if(!t){e=false;break}}}}else{e=false}IOL.cmp.iubenda=e;n()};var t=function(e,i){if(IOL.cmp.tcf!==null)return;var t=true;if(typeof e!=="undefined"&&typeof e.purpose!=="undefined"&&typeof e.purpose.consents!=="undefined"){for(var o=1;o<=10;o++){var a=false;if(typeof e.purpose.consents[o]!=="undefined")a=e.purpose.consents[o];if(!a){t=false;break}}}else t=false;if(t){if(typeof e!=="undefined"&&typeof e.specialFeatureOptins!=="undefined"){for(var o=1;o<=2;o++){var a=false;if(typeof e.specialFeatureOptins[o]!=="undefined")a=e.specialFeatureOptins[o];if(!a){t=false;break}}}else t=false}IOL.cmp.tcf=t;n()};if(typeof _iolconsent!=="undefined"&&typeof _iolconsent.callbacks!=="undefined")_iolconsent.callbacks.push(i);if(typeof e.__tcfapi!=="undefined")e.__tcfapi("addEventListener",2,t)}})(window);(function(e){if(typeof e.IOLHP==="undefined")e.IOLHP={};if(typeof IOLHP.profiling==="undefined")IOLHP.profiling={};if(typeof IOLHP.profiling.data==="undefined"){IOLHP.profiling.data=null;var n=null;if(typeof IOLHP.profiling.callbacks==="undefined")IOLHP.profiling.callbacks=[];var i=function(){if(IOL.cmp.both===null||n===null||IOLHP.profiling.data!==null)return;if(!IOL.cmp.both)IOLHP.profiling.data=[];else IOLHP.profiling.data=n;console.log("*** PROFILING CALLBACK",IOLHP.profiling.data,IOL.cmp.both,IOLHP.profiling.callbacks.length);for(var e=0;e<IOLHP.profiling.callbacks.length;e++){IOLHP.profiling.callbacks[e](IOLHP.profiling.data)}IOLHP.profiling.callbacks.push=function(e){e(IOLHP.profiling.data)}};var t=function(e){n=e;i()};e.iol_profiling_cbk=t;IOL.cmp.callbacks.push(i)}})(window);function trackPerfContent20(){window.IOLMetricsConf={sample:50,domain:"wwwtest.virgilio.it",testab:_ABTestingTrack,basic:true,extended:true,adv:true,slots:["admputop","adwallpaper","admasthead","admpumiddle","adoutofpage"],visibility:true,max:12e4,grouped:6,groupTimeout:1e3,pageid:"hp"};setTimeout(function(){var e=document.createElement("script");e.src=_PUB_PATH+"/js/track20_8.min.js?"+_HPJS_NOCACHE;document.getElementsByTagName("body")[0].appendChild(e)},100)}var mustHaveATFStatus=false;function mustHaveATF(){if(!mustHaveATFStatus){mustHaveATFStatus=true;var e=document.createElement("script");e.src=_PUB_PATH+"/common/superheader_scripts.min.js?"+_SUPERHEADER_NOCACHE;document.getElementsByTagName("body")[0].appendChild(e);var e=document.createElement("script");e.src=_PUB_PATH+"/js/iol_evnt_v2b.min.js";document.getElementsByTagName("body")[0].appendChild(e);e.onload=function(){if(window.IOL&&window.IOL.EVNT&&window.IOL.EVNT.evMngrCls){window.IOL=window.IOL||{};window.IOL.evMngr=window.IOL.evMngr||new window.IOL.EVNT.evMngrCls;window.IOL.superheader_clk_params=window.IOL.superheader_clk_params||{domain:window.location.hostname,superheader_ver:"1",area:"superheader"};window.IOL.footer_clk_params=window.IOL.footer_clk_params||{domain:window.location.hostname,footer_ver:"1",area:"footer"};trackPerfContent20()}};if(!isIeLt10){var e=document.createElement("script");e.src=_PUB_PATH+"/js/hp.min.js?"+_HPJS_NOCACHE;document.getElementsByTagName("body")[0].appendChild(e);if(typeof _CUSTOMIZATION==="undefined")_CUSTOMIZATION=0;if(_CUSTOMIZATION===0){setTimeout(function(){var e=document.createElement("script");e.src=_PUB_PATH+"/js/customize.min.js?_"+_HPJS_NOCACHE;document.getElementsByTagName("body")[0].appendChild(e)},3e3)}else{var n=document.createElement("script");n.src=_PUB_PATH+"/js/customize.min.js?_"+_HPJS_NOCACHE;document.getElementsByTagName("body")[0].appendChild(n)}}else{var e=document.createElement("script");e.src=_PUB_PATH+"/js/hp.ie.min.js?"+_HPJS_NOCACHE;document.getElementsByTagName("body")[0].appendChild(e)}}}var scriptsToBeDelayedStatus=false;function scriptsToBeDelayed(){if(!scriptsToBeDelayedStatus){scriptsToBeDelayedStatus=true;setTimeout(function(){if(_OPT_NLSN){var e=document.createElement("script");e.src="//secure-it.imrworldwide.com/v60.js";document.getElementsByTagName("body")[0].appendChild(e);e.onload=function(){var e={cid:"matrix-it",content:"0",server:"secure-it"};var n={check_cookie:0};var i=nol_t(e,n);i.record().post()}}if(Math.random()<.1){var n=document.createElement("script");n.setAttribute("async","");n.src="//www.googletagmanager.com/gtag/js?id=G-WKGZWBS7EY";document.getElementsByTagName("body")[0].appendChild(n);n.onload=function(){window.dataLayer=window.dataLayer||[];function e(){dataLayer.push(arguments)}e("js",new Date);e("config","G-WKGZWBS7EY",{anonymize_ip:true})}}setTimeout(function(){for(var e=0;e<performanceLog.length;e++){var n=performanceLog[e];if(n.msg!=""){window.IOLMetricsTrack(n.msg,n.value)}}if(navigator&&navigator.connection){window.IOLMetricsTrack("test_netpeed_kbs_hp",navigator.connection.downlink*1e3)}},1e3)},1e3)}}$(window).on("scroll",function(e){if(!mustHaveATFStatus||!scriptsToBeDelayedStatus){mustHaveATF();scriptsToBeDelayed()}});if(!isSetNoadv2501){trackADVPerformance();mustHaveATF();if(!isMobile){var se2=document.createElement("script");se2.src="//static.criteo.net/js/ld/publishertag.js";document.getElementsByTagName("body")[0].appendChild(se2);se2.onload=function(){Criteo.DisplayAcceptableAdIfAdblocked({zoneid:352491,containerid:"admputop",ct0:"#CLICK_URL_UNESC#",collapseContainerIfNotAdblocked:false,callIfNotAdBlocked:function(){googletag.cmd.push(function(){googletag.display("admputop")})}});Criteo.DisplayAcceptableAdIfAdblocked({zoneid:383918,containerid:"admpumiddle",ct0:"#CLICK_URL_UNESC#",collapseContainerIfNotAdblocked:false,callIfNotAdBlocked:function(){googletag.cmd.push(function(){googletag.display("admpumiddle")})}})}}}if(typeof _JS_TIMEOUT!="undefined")setTimeout(mustHaveATF,_JS_TIMEOUT);if(typeof _JS_TIMEOUT!="undefined")setTimeout(scriptsToBeDelayed,_JS_TIMEOUT);if(isMobile||isTablet)fallbackNative();var _notifications_conf={sample:30,daysOfSilence:5,appid:"05519dd7-eee8-4330-a31b-eb21d95731a3",tagsFunction:function(){var e={};var n="desktop";try{if(isTablet)n="tablet";else if(isSmartphone)n="smartphone"}catch(e){}e.device=n;var i=false,t=false,o=false;try{o=window.IOL.adv.getProfile("gender");if(o)i=o.gender;o=window.IOL.adv.getProfile("age");if(o)t=o.age}catch(e){}if(i)e.gender=i;if(t)e.age=t;return e},bi:{dom:"wwwtest.virgilio.it",ref_host:"www.virgilio.it",ref_path:"/",site:"hpvirgilio",res:1192}};if(window.location.href.indexOf("hpdev.")!=-1){_notifications_conf.appid="9678221c-213e-4b54-b7d8-8e7af8b86938"}var _notifications=new function(){var e=this;this.popup=false;this.conf={sample:0,daysOfSilence:5,tags:{},appid:"9678221c-213e-4b54-b7d8-8e7af8b86938",tagsFunction:false,welcome:{disable:false,title:"Grazie per esserti iscritto",message:"Lo staff di Virgilio"},clickHide:true,bxmp:"https://evnt.iol.it/v2?&bxmp=[DOM]%2C%2C[REF_HOST]%2C[REF_PATH]%2C[SITE]-push-dialog%2C[SITE]%253Bpush-dialog%253Bopenpopup%2C[RES]%2C&nc=[RND]",ck:"https://evnt.iol.it/v2?&ck=[DOM]%2C%2C[REF_HOST]%2C[REF_PATH]%2C[SITE]-push-dialog-[KEY]%2C%2C[SITE]%2Cpushdialog%2C[KEY]%2C%2C%2C%2C%2C[RES]%2C%2C0&nc=[RND]",bi:false};this.safe=false;var n=false;this.getCookie=function(e){var n=document.cookie.match("(^|;) ?"+e+"=([^;]*)(;|$)");return n?n[2]:null};this.setCookie=function(e,n,i){var t=new Date;t.setTime(t.getTime()+24*60*60*1e3*i);document.cookie=e+"="+n+";path=/;expires="+t.toGMTString()};this.deleteCookie=function(n){e.setCookie(n,"",-1)};this.init=function(){this.parseConf();var n=0;n=e.getCookie("_prenotify_rnd");if(!n){n=Math.floor(Math.random()*100+1);e.setCookie("_prenotify_rnd",n,365)}if(Number(n)>this.conf.sample)return;var i=document.createElement("script");i.setAttribute("async","");i.src="https://cdn.onesignal.com/sdks/OneSignalSDK.js";document.getElementsByTagName("body")[0].appendChild(i);window.OneSignal=window.OneSignal||[];OneSignal.push(function(){if(OneSignal.isPushNotificationsSupported()){console.log("*** OS SUPPORT");OneSignal.init({appId:e.conf.appid,autoRegister:false,notifyButton:{enable:false},welcomeNotification:e.conf.welcome,requiresUserPrivacyConsent:true})}});if(typeof this.conf.tagsFunction==="function")this.conf.tags=this.conf.tagsFunction();IOL.cmp.callbacks.push(function(n){setTimeout(function(){OneSignal.push(function(){OneSignal.provideUserConsent(n);console.log("*** OS CONS",n);if(n){OneSignal.getNotificationPermission(function(n){console.log("*** OS GNP");if(n==="default"){e.defaultStatus()}else if(n==="granted"){e.setTags()}});OneSignal.on("subscriptionChange",function(n){console.log("*** OS CHANGE");e.change(n)})}})},500)})};this.defaultStatus=function(){e.deleteCookie("_prenotify_data");if(e.getCookie("_prenotify"))return;e.open();if(e.conf.clickHide){if(window.addEventListener)window.addEventListener("click",function(){if(!e.safe)e.notNow()})}};this.change=function(n){if(n)e.setTags(true)};this.notNow=function(n){if(!e.popup)return;if(n){e._();e.sendBi("ck","notnow")}e.setCookie("_prenotify",1,e.conf.daysOfSilence);e.close();if(e.conf.clickHide){if(window.addEventListener)window.removeEventListener("click",function(){if(!e.safe)e.notNow()})}};this.closeD=function(n){if(n){e._();e.sendBi("ck","closepopup")}e.notNow()};this._=function(){e.safe=true;if(n)clearTimeout(n);n=setTimeout(function(){e.safe=false},500)};this.activate=function(n){if(n){e._();e.sendBi("ck","agree")}OneSignal.registerForPushNotifications();e.close()};this.open=function(){e.popup=true;document.body.className=document.body.className+" preNotify";e.sendBi("bxmp")};this.close=function(){e.popup=false;document.body.className=document.body.className.replace(" preNotify","")};this.setTags=function(n){if(typeof n==="undefined")n=false;if(e.conf.tags===false)return;if(!e.isEmpty(e.conf.tags)){var i=e.getCookie("_prenotify_data");if(i)i=Number(i);else i=0;var t=e.countProp(e.conf.tags);if(t<=i)return;console.log("UPDATEDTAGS "+t);OneSignal.sendTags(e.conf.tags,function(i){if(!n)e.setCookie("_prenotify_data",t,365)})}};this.sendBi=function(n,i){if(!e.conf.bi)return;if(typeof n==="undefined")n="bxmp";if(typeof i==="undefined")i="";var t=new Date;var o=e.conf.bxmp;if(n=="ck")o=e.conf.ck;o=o.replace(/\[DOM\]/g,e.conf.bi.dom);o=o.replace(/\[REF_HOST\]/g,e.conf.bi.ref_host);o=o.replace(/\[REF_PATH\]/g,e.conf.bi.ref_path);o=o.replace(/\[SITE\]/g,e.conf.bi.site);o=o.replace(/\[RES\]/g,e.conf.bi.res);o=o.replace(/\[RND\]/g,t.getTime());o=o.replace(/\[KEY\]/g,i);var a=new Image;a.src=o};this.sendClick=function(){};this.parseConf=function(){if(typeof _notifications_conf==="undefined")return;if(typeof _notifications_conf.sample!=="undefined")this.conf.sample=_notifications_conf.sample;if(_notifications_conf.daysOfSilence)this.conf.daysOfSilence=_notifications_conf.daysOfSilence;if(_notifications_conf.tags)this.conf.tags=_notifications_conf.tags;if(_notifications_conf.tagsFunction)this.conf.tagsFunction=_notifications_conf.tagsFunction;if(_notifications_conf.appid)this.conf.appid=_notifications_conf.appid;if(_notifications_conf.welcome)this.conf.welcome=_notifications_conf.welcome;if(_notifications_conf.clickHide)this.conf.clickHide=_notifications_conf.clickHide;if(_notifications_conf.bi)this.conf.bi=_notifications_conf.bi};this.isEmpty=function(e){for(var n in e){if(e.hasOwnProperty(n))return false}return JSON.stringify(e)===JSON.stringify({})};this.countProp=function(e){var n=0;for(var i in e)n++;return n}};_notifications.init();